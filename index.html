<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SpinTrade</title>
<style>
  /* ====== Variables & Base ====== */
  :root{
    --bg:#07070b;
    --card:#0f1116;
    --muted:#9aa3b2;
    --accent1:#00e6b8; /* neon green */
    --accent2:#7a4bff; /* purple */
    --gold:#ffd166;
    --glass: rgba(255,255,255,0.03);
    --glass-2: rgba(255,255,255,0.02);
    --glass-border: rgba(255,255,255,0.04);
    --radius:14px;
    --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
    --sans: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:var(--sans);
    background:
      radial-gradient(1200px 600px at 10% 10%, rgba(122,75,255,0.08), transparent 8%),
      radial-gradient(1000px 500px at 90% 90%, rgba(0,230,184,0.05), transparent 10%),
      var(--bg);
    color:#e6eef5;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    padding:24px;
  }

  /* ====== Layout ====== */
  .st-container{max-width:1200px;margin:0 auto;display:grid;grid-template-columns:320px 1fr 300px;gap:18px;}
  @media (max-width:980px){ .st-container{grid-template-columns:1fr; padding-bottom:40px} .st-right, .st-left{order:2} .st-main{order:1} }

  /* Left panel (stats) */
  .st-card{background:linear-gradient(180deg,var(--card), #0b0c11);border-radius:var(--radius);padding:18px;border:1px solid var(--glass-border);box-shadow:0 6px 20px rgba(2,6,23,0.6)}
  .st-left .balance{font-size:20px;font-weight:700}
  .st-left .small{color:var(--muted);font-size:13px;margin-top:6px}
  .st-stat-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:12px}
  .st-stat{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:12px;border-radius:10px;border:1px solid var(--glass-border)}
  .st-stat h4{margin:0;font-size:12px;color:var(--muted)}
  .st-stat p{margin:6px 0 0;font-weight:700}

  /* Center / main */
  .st-main{display:flex;flex-direction:column;gap:16px}
  .hero{
    position:relative;overflow:hidden;padding:22px;border-radius:var(--radius);min-height:120px;background:linear-gradient(135deg, rgba(122,75,255,0.08), rgba(0,230,184,0.03));
    border:1px solid var(--glass-border);
  }
  .hero h1{margin:0;font-size:20px}
  .hero p{margin:6px 0 0;color:var(--muted);font-size:13px}

  .ticker{
    margin-top:12px;padding:8px 10px;border-radius:10px;background:var(--glass);display:flex;gap:12px;align-items:center;overflow:hidden;
  }
  .ticker .item{min-width:90px;font-family:var(--mono);font-size:13px;padding:6px;border-radius:8px;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);display:flex;justify-content:space-between;gap:8px}
  .ticker .up{color:#86ffcd} .ticker .down{color:#ff9fb1}

  /* Wheel / chart row */
  .card-row{display:grid;grid-template-columns:1fr 360px;gap:16px}
  @media (max-width:980px){ .card-row{grid-template-columns:1fr} }

  /* roulette wheel */
  .wheel-wrap{display:flex;flex-direction:column;gap:12px;align-items:center;justify-content:center;padding:18px;background:linear-gradient(180deg,var(--card),#0b0c11);border-radius:var(--radius);border:1px solid var(--glass-border)}
  .wheel {width:260px;height:260px;border-radius:50%;position:relative;overflow:visible;display:flex;align-items:center;justify-content:center;background:conic-gradient(#7a4bff 0 20%, #00e6b8 20% 40%, #ffd166 40% 60%, #7a4bff 60% 80%, #00e6b8 80% 100%);box-shadow:0 8px 30px rgba(0,0,0,0.6), inset 0 2px 12px rgba(255,255,255,0.02)}
  .wheel .center{position:absolute;width:110px;height:110px;border-radius:50%;background:linear-gradient(180deg,#0f1116, #0b0c11);display:flex;flex-direction:column;align-items:center;justify-content:center;border:6px solid rgba(255,255,255,0.03)}
  .wheel .center small{display:block;color:var(--muted);font-size:12px}
  .wheel .pointer{position:absolute;top:-20px;left:50%;transform:translateX(-50%);width:0;height:0;border-left:10px solid transparent;border-right:10px solid transparent;border-bottom:20px solid var(--gold);filter:drop-shadow(0 3px 6px rgba(0,0,0,0.6))}

  /* spin controls */
  .spin-controls{display:flex;gap:10px;margin-top:8px}
  .btn{padding:10px 14px;border-radius:12px;border:1px solid var(--glass-border);background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);cursor:pointer;font-weight:700}
  .btn:active{transform:translateY(1px)}
  .btn-primary{background:linear-gradient(90deg,var(--accent2),var(--accent1));color:#051017;border:none;box-shadow:0 8px 22px rgba(122,75,255,0.08)}
  .btn-ghost{background:transparent;color:var(--accent1);border:1px dashed rgba(0,230,184,0.15)}

  /* right column */
  .st-right .card-list{display:flex;flex-direction:column;gap:12px}
  .list-item{display:flex;align-items:center;gap:12px;padding:12px;border-radius:12px;background:linear-gradient(180deg,var(--glass),transparent);border:1px solid var(--glass-border)}
  .list-item .dot{width:10px;height:10px;border-radius:50%}
  .leader{font-weight:700}

  /* modal / toast */
  .st-modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:linear-gradient(rgba(3,5,10,0.6), rgba(3,5,10,0.8));z-index:60}
  .st-modal .inner{width:320px;padding:18px;border-radius:12px;background:#071018;border:1px solid rgba(255,255,255,0.04);text-align:center}
  .st-toast{position:fixed;right:20px;bottom:20px;z-index:70;padding:12px 16px;border-radius:10px;background:#071018;border:1px solid rgba(255,255,255,0.04);box-shadow:0 10px 30px rgba(0,0,0,0.5)}

  /* simple chart area */
  .chart-card{padding:12px;border-radius:12px;background:linear-gradient(180deg,var(--card),#0b0c11);border:1px solid var(--glass-border)}
  canvas{width:100%;height:200px;display:block}

  /* small helpers */
  .muted{color:var(--muted)}
  .flex{display:flex;align-items:center}
  .spacer{flex:1}
  .glow{text-shadow:0 6px 30px rgba(122,75,255,0.12)}
</style>
</head>
<body>

<div class="st-container" id="spintrade-app">
  <!-- LEFT: stats -->
  <aside class="st-left">
    <div class="st-card">
      <div style="display:flex;align-items:center;gap:12px">
        <div style="width:52px;height:52px;border-radius:12px;background:linear-gradient(135deg,var(--accent2),var(--accent1));display:flex;align-items:center;justify-content:center;font-weight:800">ST</div>
        <div>
          <div class="balance" id="st-balance">KES 1,000</div>
          <div class="small muted">Practice balance • local only</div>
        </div>
      </div>

      <div class="st-stat-grid" style="margin-top:16px">
        <div class="st-stat">
          <h4>Available Coins</h4>
          <p id="st-coins">1,000</p>
        </div>
        <div class="st-stat">
          <h4>Wins Today</h4>
          <p id="st-wins">0</p>
        </div>
        <div class="st-stat">
          <h4>Trades</h4>
          <p id="st-trades">0</p>
        </div>
        <div class="st-stat">
          <h4>Streak</h4>
          <p id="st-streak">0</p>
        </div>
      </div>

      <div style="margin-top:14px">
        <button class="btn btn-primary" id="st-demo-deposit">+ Demo KES 500</button>
        <button class="btn btn-ghost" id="st-reset" style="margin-left:8px">Reset</button>
      </div>
    </div>

    <div style="height:12px"></div>

    <div class="st-card">
      <h4 style="margin:0">Quick Actions</h4>
      <div style="display:flex;gap:8px;margin-top:12px">
        <button class="btn" id="st-open-wheel">Open Wheel</button>
        <button class="btn" id="st-open-chart">Open Chart</button>
      </div>
    </div>
  </aside>

  <!-- CENTER: main -->
  <main class="st-main">
    <div class="hero st-card">
      <h1 class="glow">SpinTrade — Play the Markets. Win Practice Coins.</h1>
      <p class="muted">A lightweight practice UI combining casino-style spins and market charts to learn UI + front-end interactions.</p>

      <div class="ticker" id="st-ticker" aria-hidden="true">
        <!-- ticker items inserted by JS -->
      </div>
    </div>

    <div class="card-row">
      <div>
        <div class="wheel-wrap">
          <div class="wheel" id="st-wheel" aria-hidden="true">
            <div class="pointer" aria-hidden="true"></div>
            <div class="center">
              <div style="font-weight:800;font-size:18px">SPIN</div>
              <small class="muted">Practice mode</small>
            </div>
          </div>

          <div class="spin-controls">
            <select id="st-bet-amt" class="btn" style="min-width:110px">
              <option value="50">Bet KES 50</option>
              <option value="100" selected>Bet KES 100</option>
              <option value="200">Bet KES 200</option>
            </select>
            <button class="btn btn-primary" id="st-spin-btn">SPIN</button>
            <button class="btn" id="st-auto-spin">AUTO</button>
          </div>

          <div style="display:flex;gap:10px;align-items:center;margin-top:10px">
            <div class="muted">Result:</div>
            <div id="st-last-result" style="font-weight:800">—</div>
            <div class="spacer"></div>
            <div class="muted">Odds:</div>
            <div id="st-odds" style="font-weight:700">1:3</div>
          </div>
        </div>

        <div style="height:16px"></div>

        <div class="chart-card st-card">
          <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
            <div style="font-weight:800">Market Pulse</div>
            <div class="muted" style="font-size:13px">Live practice candles</div>
            <div class="spacer"></div>
            <button class="btn" id="st-add-trade">Place Demo Trade</button>
          </div>
          <canvas id="st-chart" width="800" height="200" aria-hidden="true"></canvas>
        </div>
      </div>

      <aside class="st-right">
        <div class="st-card card-list">
          <h4 style="margin:0">Live Winners</h4>
          <div id="st-leaderboard" style="margin-top:10px">
            <!-- items by JS -->
          </div>
        </div>

        <div style="height:12px"></div>

        <div class="st-card">
          <h4 style="margin:0">Recent Activity</h4>
          <div style="margin-top:10px" id="st-activity">
            <div class="muted">No activity yet</div>
          </div>
        </div>
      </aside>
    </div>
  </main>
</div>

<!-- Modal -->
<div class="st-modal" id="st-modal">
  <div class="inner">
    <div id="st-modal-msg" style="font-size:18px;font-weight:800"></div>
    <div class="muted" style="margin-top:8px" id="st-modal-sub"></div>
    <div style="margin-top:14px">
      <button class="btn btn-primary" id="st-modal-ok">OK</button>
    </div>
  </div>
</div>

<!-- Toast -->
<div class="st-toast" id="st-toast" style="display:none">Welcome to SpinTrade practice UI</div>

<script>
/*
  SpinTrade practice UI
  - Scoped so as not to conflict with other scripts.
  - Exposes window.SpinTradeUI with a tiny API.
*/
(function(root){
  const NAMESPACE = 'spintrade'; // for localStorage keys
  const STORAGE_KEY = NAMESPACE + '_balance_v1';
  const initialBalance = 1000;
  const state = {
    balance: initialBalance,
    coins: initialBalance,
    wins: 0,
    trades: 0,
    streak: 0,
    lastResult: null,
    autoSpinInterval: null
  };

  /* Utilities */
  const $ = (sel, rootEl=document) => rootEl.querySelector(sel);
  const $$ = (sel, rootEl=document) => Array.from(rootEl.querySelectorAll(sel));
  const fmtKES = v => 'KES ' + Number(v).toLocaleString();
  const rand = (a,b)=> Math.floor(Math.random()*(b-a+1))+a;

  /* Persist/load */
  function loadState(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(raw){
        const parsed = JSON.parse(raw);
        if(typeof parsed.balance === 'number') state.balance = parsed.balance;
      } else {
        state.balance = initialBalance;
      }
    }catch(e){
      state.balance = initialBalance;
    }
    state.coins = state.balance;
  }
  function saveState(){ localStorage.setItem(STORAGE_KEY, JSON.stringify({balance: state.balance})); }

  /* UI updates */
  function updateLeftPanel(){
    $('#st-balance').textContent = fmtKES(state.balance);
    $('#st-coins').textContent = state.coins;
    $('#st-wins').textContent = state.wins;
    $('#st-trades').textContent = state.trades;
    $('#st-streak').textContent = state.streak;
  }
  function pushActivity(txt){
    const root = $('#st-activity');
    const node = document.createElement('div');
    node.style.marginTop = '8px';
    node.textContent = txt;
    root.prepend(node);
    // keep only last 8
    Array.from(root.children).slice(8).forEach(c=>c.remove());
  }
  function showToast(msg, time=2200){
    const t = $('#st-toast'); t.textContent = msg; t.style.display='block';
    setTimeout(()=> t.style.display='none', time);
  }
  function showModal(title, subtitle){
    $('#st-modal-msg').textContent = title;
    $('#st-modal-sub').textContent = subtitle || '';
    $('#st-modal').style.display = 'flex';
  }
  function hideModal(){ $('#st-modal').style.display = 'none'; }

  /* Ticker simulation */
  const tickerSymbols = ['BTC/KES','ETH/KES','AAPL','GOOG','GOLD','USD/KES'];
  function initTicker(){
    const box = $('#st-ticker');
    box.innerHTML='';
    for(const s of tickerSymbols){
      const item = document.createElement('div');
      item.className = 'item';
      item.innerHTML = <div style="font-weight:700">${s}</div><div class="${Math.random()>0.5?'up':'down'}"> ${ (Math.random()>0.5?'+':'-')}${(Math.random()*5).toFixed(2)}%</div>;
      box.appendChild(item);
    }
    // roll every 3s
    setInterval(()=>{
      // randomize one element
      const items = $$('.item', box);
      if(items.length===0) return;
      const i = rand(0, items.length-1);
      items[i].querySelector('div:nth-child(2)').textContent = (Math.random()>0.5?'+':'-') + (Math.random()*6).toFixed(2) + '%';
    }, 3000);
  }

  /* Leaderboard demo */
  const demoNames = ['Ada', 'Moses', 'Ruth', 'Ken', 'Zuri', 'Luka', 'Nia'];
  function initLeaderboard(){
    const root = $('#st-leaderboard');
    root.innerHTML = '';
    for(let i=0;i<4;i++){
      const el = document.createElement('div');
      el.className='list-item';
      const dot = document.createElement('div'); dot.className='dot';
      dot.style.background = i%2? 'linear-gradient(90deg,var(--accent2),var(--accent1))' : 'linear-gradient(90deg,var(--gold),var(--accent1))';
      el.innerHTML = `<div style="width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg,rgba(255,255,255,0.02),transparent);display:flex;align-items:center;justify-content:center">${demoNames[i].slice(0,1)}</div>
                      <div>
                        <div class="leader">${demoNames[i]}</div>
                        <div class="muted" style="font-size:13px">Won KES ${rand(100,1500)}</div>
                      </div>
                      <div class="spacer"></div>
                      <div style="font-weight:800">+${rand(1,200)}</div>`;
      root.appendChild(el);
    }
  }

  /* Chart (tiny simulated chart using Canvas) */
  function initChart(){
    const canvas = $('#st-chart');
    const ctx = canvas.getContext('2d');
    // responsive canvas
    function resize(){
      const rect = canvas.getBoundingClientRect();
      const dpi = window.devicePixelRatio || 1;
      canvas.width = rect.width * dpi;
      canvas.height = 200 * dpi;
      ctx.setTransform(dpi,0,0,dpi,0,0);
      draw();
    }
    const points = Array.from({length:40}, ()=> 50 + Math.random()*40);
    function draw(){
      const w = canvas.clientWidth;
      const h = 200;
      ctx.clearRect(0,0,w,h);
      // background grid
      ctx.strokeStyle = 'rgba(255,255,255,0.03)';
      ctx.lineWidth = 1;
      for(let y=0;y<h;y+=40){ ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(w,y); ctx.stroke(); }
      // line
      ctx.beginPath();
      for(let i=0;i<points.length;i++){
        const x = (i/(points.length-1)) * w;
        const y = h - ( (points[i]-30)/120 * h );
        if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
      }
      // gradient stroke
      const g = ctx.createLinearGradient(0,0,w,0);
      g.addColorStop(0,'#7a4bff'); g.addColorStop(1,'#00e6b8');
      ctx.strokeStyle = g;
      ctx.lineWidth = 2.6;
      ctx.stroke();
      // fill gradient
      ctx.lineTo(w,h); ctx.lineTo(0,h); ctx.closePath();
      const g2 = ctx.createLinearGradient(0,0,0,h);
      g2.addColorStop(0,'rgba(122,75,255,0.08)'); g2.addColorStop(1,'rgba(0,230,184,0.02)');
      ctx.fillStyle = g2;
      ctx.fill();
    }
    // animate: push new point every 1.2s
    setInterval(()=>{
      points.shift();
      points.push(40 + Math.random()*80);
      draw();
    }, 1200);
    window.addEventListener('resize', resize);
    resize();
  }

  /* Wheel spin logic */
  const WHEEL_SEGMENTS = ['GREEN','PURPLE','GOLD','GREEN','TURQUOISE','PURPLE','GOLD','GREEN'];
  function spinOnce(bet){
    // cost: deduct bet immediately
    state.balance -= bet;
    state.trades += 1;
    saveState(); updateLeftPanel();

    // spin simulation: choose random index weighted slightly
    const idx = rand(0, WHEEL_SEGMENTS.length*4 - 1) % WHEEL_SEGMENTS.length;
    const result = WHEEL_SEGMENTS[idx];
    // define payout multipliers:
    const payouts = { 'GREEN':0, 'PURPLE':2, 'GOLD':3, 'TURQUOISE':5 };
    const multiplier = payouts[result] || 0;
    let winAmount = Math.floor(bet * multiplier);
    if(winAmount>0){
      state.balance += winAmount;
      state.wins += 1;
      state.streak += 1;
      pushActivity(Won KES ${winAmount} on ${result});
      showToast(You won KES ${winAmount}!);
    } else {
      state.streak = 0;
      pushActivity(Lost KES ${bet} on ${result});
    }
    state.lastResult = {result, multiplier, winAmount};
    saveState();
    updateLeftPanel();
    $('#st-last-result').textContent = result + (winAmount?(' +'+winAmount):'');
    return state.lastResult;
  }

  /* Animates wheel rotation visually and resolves promise when done */
  function animateWheelAndResolve(bet){
    return new Promise(resolve=>{
      const wheel = $('#st-wheel');
      // choose a random final angle based on result
      const segmentIndex = rand(0, WHEEL_SEGMENTS.length - 1);
      const anglePerSeg = 360 / WHEEL_SEGMENTS.length;
      // Add multiple rotations + final offset, offset so that pointer lands on center of segment
      const finalAngle = 360*6 + (segmentIndex * anglePerSeg) + anglePerSeg/2 + rand(-8,8);
      wheel.style.transition = 'transform 3s cubic-bezier(.12,.9,.28,1)';
      wheel.style.transform = rotate(${finalAngle}deg);
      // after transition ends
      const handler = () => {
        wheel.style.transition = '';
        // normalize rotation to a small angle to avoid accumulating transforms
        const normalized = finalAngle % 360;
        wheel.style.transform = rotate(${normalized}deg);
        wheel.removeEventListener('transitionend', handler);
        // determine result by segmentIndex mapping
        const result = WHEEL_SEGMENTS[ segmentIndex % WHEEL_SEGMENTS.length ];
        // Compute payout (use same spinOnce logic but without double-deduct)
        // We'll compute payout based on result and bet:
        const payouts = { 'GREEN':0, 'PURPLE':2, 'GOLD':3, 'TURQUOISE':5 };
        const multiplier = payouts[result] || 0;
        const winAmount = Math.floor(bet * multiplier);
        resolve({ result, multiplier, winAmount });
      };
      wheel.addEventListener('transitionend', handler);
      // fallback timeout
      setTimeout(()=>{ wheel.removeEventListener('transitionend', handler); resolve({result:'UNKNOWN',multiplier:0,winAmount:0}); }, 4000);
    });
  }

  /* Wire UI events */
  function attachEvents(){
    $('#st-spin-btn').addEventListener('click', async function(){
      const bet = Number($('#st-bet-amt').value);
      if(bet <= 0) return showToast('Choose a bet');
      if(state.balance < bet) return showModal('Insufficient balance', 'Add demo funds or reduce bet');
      // disable button
      this.disabled = true; $('#st-spin-btn').textContent = 'SPINNING...';
      // animate wheel & await result
      const spinResult = await animateWheelAndResolve(bet);
      // apply result to state using same payout rules
      const payouts = { 'GREEN':0, 'PURPLE':2, 'GOLD':3, 'TURQUOISE':5 };
      const mult = payouts[spinResult.result] || 0;
      const win = Math.floor(bet * mult);
      if(win>0){ state.balance += win; state.wins += 1; state.streak += 1; pushActivity(Won KES ${win} (${spinResult.result})); showToast(Won KES ${win}); }
      else { state.streak = 0; pushActivity(Lost KES ${bet} (${spinResult.result})); showToast('Better luck next time'); }
      state.trades += 1;
      saveState(); updateLeftPanel();
      $('#st-last-result').textContent = spinResult.result + (win?(' +'+win):'');
      $('#st-spin-btn').disabled = false; $('#st-spin-btn').textContent = 'SPIN';
    });

    $('#st-demo-deposit').addEventListener('click', function(){
      state.balance += 500; saveState(); updateLeftPanel(); pushActivity('Demo deposit +KES 500'); showToast('Demo +KES 500');
    });

    $('#st-reset').addEventListener('click', function(){
      if(confirm('Reset demo balance and activity?')){
        state.balance = initialBalance; state.wins=0; state.trades=0; state.streak=0; saveState(); updateLeftPanel(); $('#st-activity').innerHTML='<div class="muted">No activity yet</div>'; showToast('Reset done');
      }
    });

    $('#st-open-wheel').addEventListener('click', ()=> {
      const rect = $('#st-wheel').getBoundingClientRect();
      window.scrollTo({top: rect.top - 40, behavior:'smooth'});
      showToast('Wheel focused');
    });

    $('#st-open-chart').addEventListener('click', ()=> {
      const rect = $('#st-chart').getBoundingClientRect();
      window.scrollTo({top: rect.top - 40, behavior:'smooth'});
      showToast('Chart focused');
    });

    $('#st-modal-ok').addEventListener('click', hideModal);
    $('#st-add-trade').addEventListener('click', ()=> {
      // Simple demo trade that randomly wins small amount
      if(state.balance < 50) return showModal('Low balance', 'Add demo funds');
      const bet = 50; state.balance -= bet;
      if(Math.random() < 0.48){ const win = bet + rand(10,120); state.balance += win; pushActivity(Trade WIN +KES ${win}); showToast(Trade win: +KES ${win}); state.wins += 1; } else { pushActivity(Trade loss -KES ${bet}); showToast('Trade lost'); }
      state.trades += 1; saveState(); updateLeftPanel();
    });

    $('#st-auto-spin').addEventListener('click', function(){
      if(state.autoSpinInterval){
        clearInterval(state.autoSpinInterval); state.autoSpinInterval = null; this.textContent = 'AUTO';
        showToast('Auto stopped');
        return;
      }
      // start auto with current bet
      const bet = Number($('#st-bet-amt').value);
      if(state.balance < bet) return showModal('Low balance', 'Add funds to auto-spin');
      this.textContent = 'STOP';
      state.autoSpinInterval = setInterval(async ()=>{
        if(state.balance < bet){ clearInterval(state.autoSpinInterval); state.autoSpinInterval=null; $('#st-auto-spin').textContent='AUTO'; showToast('Auto stopped — low balance'); return; }
        // animate spin but faster: just pick result and update without long animation to not block
        const seg = WHEEL_SEGMENTS[rand(0,WHEEL_SEGMENTS.length-1)];
        const payouts = { 'GREEN':0, 'PURPLE':2, 'GOLD':3, 'TURQUOISE':5 };
        state.balance -= bet;
        const win = bet * (payouts[seg] || 0);
        if(win>0){ state.balance += Math.floor(win); state.wins += 1; state.streak += 1; pushActivity(AUTO Won KES ${Math.floor(win)} (${seg})); }
        else { state.streak = 0; pushActivity(AUTO Lost KES ${bet} (${seg})); }
        state.trades += 1; saveState(); updateLeftPanel();
      }, 1500);
      showToast('Auto started');
    });

    // small keyboard shortcut: press "S" to spin
    window.addEventListener('keydown', (e)=>{ if(e.key.toLowerCase()==='s') { $('#st-spin-btn').click(); } });

  }

  /* Init app */
  function init(){
    loadState();
    updateLeftPanel();
    initTicker();
    initLeaderboard();
    initChart();
    attachEvents();
    showToast('SpinTrade ready — press "S" to spin', 1800);
  }

  // expose for debugging minimal api
  root.SpinTradeUI = {
    init,
    getState: ()=> ({...state}),
    reset: ()=> { localStorage.removeItem(STORAGE_KEY); loadState(); updateLeftPanel(); $('#st-activity').innerHTML='<div class="muted">No activity yet</div>'; showToast('Reset'); }
  };

  // start when DOM ready
  if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);
  else init();

})(window);
</script>
	<script src="index.js"></script>

</body>
</html>
